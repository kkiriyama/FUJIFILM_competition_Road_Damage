# Data Science Challenge by FUJIFILM AI Academy Brain(s) Road Damage

解答者：藏田展洋（東京大学医学部医学科4年）

## ファイルの説明
- utils.py ... 配布された600 * 600の画像をモデルに合わせてリサイズするためのファイルです。
- keras-yolo3_modified ... [YOLO V3のgithubリポジトリ](https://github.com/qqwweee/keras-yolo3)を `git clone` でコピーしたもののうち、必要なファイルだけ抜き出して改変したものです。
  - convert.py ... YOLO V3のgituhbレポジトリのREADMEに書いてある通りの変換を行うためのファイルです。自分での変更は行っていません。 `python convert.py yolov3.cfg yolov3.weights model_data/yolo.h5` を一行することでconfigの要素を考慮したモデルを構築できます。
  - train.txt ... voc_annotation.pyによって生成した、ラベルデータのPascal VOCフォーマットをYOLO V3用に変換したものです。
  - train.py ... モデルの訓練用のファイルです。今回は特に変更を行っていません。
  - voc_annotation.py ... ラベルのPascal VOCフォーマットをYOLO V3用のテキストデータに変換するためのファイルです。今回配布された画像データのディレクトリ構造に合わせて改変し、また、配布された画像のサイズとモデルの訓練などに使用する画像のサイズの違いを考慮して調整しました。
  - yolov3.cfg ... モデルのハイパーパラメータを定義するconfigファイルです。
  - yolov3.weights ... 初期値として用いたモデルの重みです。
  - font ... 出力で表示するためのフォントファイルが入っています。
  - model_data ... クラスやアンカー、モデルを定義するファイルが入っています。
    - voc_classes.txt ... 分類するクラスを定義します。今回は1から8までの8種類のクラスに分類するのでそのように変更してあります。
    - yolo_anchors.txt ... アンカーを定義します。このファイルには変更を加えていません。
    - yolo.h5 ... convert.py で生成したモデルファイルです。

## 詳細な解答手順

1. データをダウンロードしたら、まず生のデータ（画像、ラベルともに）を数百程度見ました。その結果、そもそも道路に損傷が入っていない画像が大量に入っているだとか、道路の損傷が1枚の画像に大量に含まれている、といったことがないことを確認しました。

2. 今回の問題は「物体検出問題」である。物体検出問題において予測時間と予測精度はトレードオフの関係にあることが予測されるが、実際に[文献](https://pjreddie.com/media/files/papers/YOLOv3.pdf)のグラフを見てみると最も速いのがYOLO v3であり、最も精度が高いのがRetinaNet-101であることが分かる。実世界への応用を考えたときに、トレードオフの中間地点のモデルをすべての場合に使いまわすよりもトレードオフの両極端を必要に応じて使い分ける方が効率的であると考え、今回はYOLO v3とRetinaNet-101の2つをベースに実装することにした。画像サイズについては使用できるGPUメモリや計算時間との兼ね合いになる。

3. 詳細にデータを分析していくにあたり、1.の項で大まかにつかんだ雰囲気を数字とグラフを使って可視化する。画像あたりに含まれるboxの数と、各クラスの分布を調べた。結果が下の画像である。
![Imgur](https://i.imgur.com/U3Gf7f7.png)
![Imgur](https://i.imgur.com/HGP7TKK.png)
boxの数については1, 2, 3個がほとんどを占めるが最小0個から最大8個まであることが分かる。テストデータもおおよそこれくらいの比率であろうという仮定のもと進める。







## 考察
- 今回のデータはほとんどが道路の損傷が存在するものであったが、現実にカメラ付きの車などで撮影して回る時には損傷がないものがほとんどであり、今回のモデルをそのまま適用するのは不適切であると考えらえる。使用するデータの比率に合わせた訓練データでの再学習が必要だろう。
- YOLO v3モデルは精度では劣るものの、予測が速いために予測を動画で行うことが可能である。このような機械学習の技術と、GPS、さらに将来的に自動運転の技術が組み合わされば完全自動でどの地点にどのような道路損傷があるのかをマッピングすることが可能になると考えられる。今回は道路損傷の検出であったが、道路から観測できるものを対象にすれば幅広い応用が考えられる。